# maticgasstation

## intro

_**maticgasstation** - Friend of a Matic developer_

_Tool for getting gas price recommendations before sending transactions off to matic network_

## origin

This project is inspired by [gasstation-express-oracle](https://github.com/ethgasstation/gasstation-express-oracle). Updated to work with Matic Network.

## progress

~~**This is active WIP**~~

**This will be maintained and improved overtime** :heavy_check_mark:

- Started adapting for matic network [03/07/2020]
- Completed writing, now works for Matic network [06/07/2020]
- More features to be added in near future

    - Multi-thearding support for faster performance _[ not implemented now due to race condition in threads, to be resolved ]_
    - Adding IPC based communication with node

## deployment

- First thing first, simply clone this repo into host machine
- Prepare a config file i.e. below, this needs to be supplied while invoking script. This config file holds information related to what percentage of blocks accepted in certain mininum gas price. An example config file is supplied in this repo.

```json
{
    "safelow": 35,
    "standard": 60,
    "fast": 90,
    "rpc": "wss://testnetv3-wss.matic.network",
    "pastBlockCount": 200
}
```

- **Make sure you've Python( >= 3.7.0 )**
- Now install all dependencies by running

```bash
$ python3 -m pip install -r requirements.txt
```
- Install `flit` - easy to use for building PyPI packages and also for local use.

```bash
$ python3 -m pip install -U flit
```

- `flit init` has already been done, which is why `pyproject.toml` is generated.
- Now run, before that make sure you've added `$HOME/.local/bin` to `$PATH`.

```bash
$ flit install -s
```

- Now `maticGS` will be available on your `$PATH`.
- Run using 

```bash
$ maticGS config.json ~/sinkForGasPrice.json
```

- Time to run nodejs script that will serve recommended gas prices to mass, get into `serve` directory and install dependencies

```bash
$ cd serve
$ npm install # make sure you've node and npm installed
```

- Open `./index.js` with your favourite text-editor and set `TARGETFILE` as file to be served _[ please put absolute path of file, otherwise it'll misbehave ]_
- Set desired `HOST` and `PORT`
- Now run `./index.js` _[ it's a very simple express application ]_

```bash
$ node index.js # voila !!!
```

- And that's it :wink:


## output

- Result will be like _[generated by considering past 75 non-empty blocks from mainnet ethereum]_


```json
{
    "safeLow": 20.0,
    "standard": 30.0,
    "fast": 33.0,
    "fastest": 45.0,
    "block_time": 15,
    "blockNum": 10429611
}
```

- _{'safelow', 'standard', 'fast', 'fastest'}_ are gas prices in gwei
- _blockNumber_ indicates latest block when recommendation was made
- _block\_time_ in second
